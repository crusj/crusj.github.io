---
layout: post
title: php错误类型
category: php
tags: php
---
对PHP的错误类型一直很模糊，在此进行总结。
-----
### 常见的错误类型
* E_DEPRECATED
* E_NOTICE
* E_WARNING
* E_ERROR
* E_PARSE

### E_DEPRECATED 反对
A run-time notice indicating that the code will not work in future versions of PHP
#### 情形:
* mysql函数库在7.0版本移除
### E_NOTICE 提示错误
A run-time notice indicating that the script encountered something that could possibly an error, although the situation could also occur when running a script normally。
#### 情形:
  * 使用未定义的变量
### E_WARNING 警告
A run-time warning. It is non-fatal and most errors tend to fall into this category. The execution of the script is not stopped.
#### 情形:
* include 不存在的文件
### E_ERROR 致命错误
A fatal run-time error, that can't be recovered from. The execution of the script is stopped immediately.
#### 情形:
* require一个不存在的文件
* 使用一个未定义的函数、类、接口
### E_PARSE 解析错误
The compile-time parse error. Parse errors should only be generated by the parser.
#### 情形:
* 语法错误
-----
### 捕获错误类型
> set_error_handler(callback[,$error_type=E_ALL|E_STRICT)
> The following error types **cannot be handled** with a user defined function: **E_ERROR, E_PARSE, E_CORE_ERROR, E_CORE_WARNING, E_COMPILE_ERROR, E_COMPILE_WARNING**, and most of E_STRICT raised in the file where set_error_handler() is called

#### 当用户自定了捕获异常函数，程序会绕过PHP 标准错误处理程序,除非在回调函数中返回false,error_reporting()函数也会被忽略。
```php
    set_error_handler(function($errno,$errstr){
         echo "错误码".$errno;
         echo "错误信息".$errstr;
         //return false;
    });
    echo $a;//发出一个notice
```
#### 注册一个脚本结束时或者程序发生一个fatal error执行的函数
> void register_shutdown_function ( callable $callback [, mixed $parameter [, mixed $... ]] )
可以注册多个回调函数，函数将会被依次调用

```php
   function fatal_error(){
       $error = error_get_last();
       if($error){
            //dosomethin
            $errno   = $error["type"];
            $errfile = $error["file"];
            $errline = $error["line"];
            $errstr  = $error["message"];
       }
   }
   register_shutdown_function("fatal_error");
```
---
### PHP7中一些fatal error也能被捕获
#### 例如:用了一个未定义的函数
```php
   try{
       undefinded();
   }catch(Error $e){
       echo $e->getMessage();
   }
   //Call to undefined function undefinded()
```
